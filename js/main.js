!function(r,o){var c=function(e){return o.querySelector(e)},e=o.body,t=c("html"),i=c("#gotop"),n=c("#menu"),l=c("#header"),d=c("#mask"),s=c("#menu-toggle"),a=c("#menu-off"),f=c("#loading"),v=r.requestAnimationFrame,u=navigator.userAgent,h=-1!==u.indexOf("Mobile")||-1!==u.indexOf("Android")||-1!==u.indexOf("iPhone")||-1!==u.indexOf("iPad")||-1!==u.indexOf("KFAPWI")?"touchstart":"click",L=function(){},g=function(e){var t=e.offsetLeft,i=e.offsetTop;if(e.offsetParent){var n=arguments.callee(e.offsetParent);t+=n.x,i+=n.y}return{x:t,y:i}},p=-1!==u.indexOf("Firefox")?o.documentElement:e,m={goTop:function(){var e=p.scrollTop;400<e?(p.scrollTop=e-400,v(arguments.callee)):p.scrollTop=0},toggleGotop:function(e){e>r.innerHeight/2?i.classList.add("in"):i.classList.remove("in")},toggleMenu:function(e){e?(n.classList.remove("hide"),r.innerWidth<1241&&(d.classList.add("in"),n.classList.add("show"),t.classList.add("lock"))):(n.classList.remove("show"),d.classList.remove("in"),t.classList.remove("lock"))},fixedHeader:function(e){e>l.clientHeight?l.classList.add("fixed"):l.classList.remove("fixed")},fixedToc:function(){var s=c("#post-toc");if(!s||!s.children.length)return L;var t=g(s).y,a=l.clientHeight,o=c("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return s.querySelector('a[href="#'+o[0].id+'"]').parentNode.classList.add("active"),[].forEach.call(s.querySelectorAll('a[href*="#"]'),function(e){e.addEventListener("click",function(e){e.preventDefault(),p.scrollTop=g(c('[id="'+decodeURIComponent(this.hash).substr(1)+'"]')).y-a+10})}),function(e){t-a<e?s.classList.add("fixed"):s.classList.remove("fixed"),function(e){for(var t=0,i=o.length;t<i;t++)if(e>g(o[t]).y-a){s.querySelector("li.active").classList.remove("active");var n=s.querySelector('a[href="#'+o[t].id+'"]').parentNode;n.classList.add("active"),n.offsetTop>=s.clientHeight-a?s.scrollTop=n.offsetTop-s.clientHeight+parseInt(r.innerHeight/3):s.scrollTop=0}e<g(o[0]).y&&(s.querySelector("li.active").classList.remove("active"),s.querySelector('a[href="#'+o[0].id+'"]').parentNode.classList.add("active"))}(e)}}(),share:function(){var e,t,i=c("#global-share"),n=c("#menu-share"),s=o.createElement("div"),a=c(".share-sns");s.innerHTML=BLOG_SHARE.summary,e=s.innerText,s=void 0,t="http://www.jiathis.com/send/?webid={service}&url="+BLOG_SHARE.url+"&title="+BLOG_SHARE.title+"&summary="+e+"&pic="+location.protocol+"//"+location.host+BLOG_SHARE.pic,[].forEach.call(a,function(e){e.addEventListener("click",function(){var e;e=this.dataset.service,r.open(encodeURI(t.replace("{service}",e)))},!1)}),n.addEventListener(h,function(){d.classList.add("in"),i.classList.add("in")},!1),d.addEventListener(h,function(){i.classList.remove("in"),d.classList.remove("in")},!1)},search:function(){c("#search").addEventListener(h,function(){c("#search-wrap").classList.toggle("in")})},reward:function(){var t=c("#reward"),e=c("#rewardBtn"),i=c("#rewardOff");function n(){d.classList.remove("in"),t.classList.remove("in"),setTimeout(function(){t.classList.remove("ready"),o.removeEventListener(h,s)},300)}function s(e){t.contains(e.target)||n()}t&&(e.addEventListener(h,function(){return t.classList.contains("in")?n():(d.classList.add("in"),t.classList.add("ready"),void setTimeout(function(){t.classList.add("in"),o.addEventListener(h,s)},0))}),i.addEventListener(h,n))}(),fixNavMinH:function(){var e=c(".nav");e.style.minHeight=e.parentNode.clientHeight-e.nextElementSibling.offsetHeight+"px"}};r.addEventListener("load",function(){m.fixNavMinH(),f.classList.remove("active")}),r.addEventListener("resize",function(){m.fixNavMinH(),m.toggleMenu()}),i.addEventListener(h,function(){v(m.goTop)},!1),s.addEventListener(h,function(e){m.toggleMenu(!0),e.preventDefault()},!1),a.addEventListener(h,function(){n.classList.add("hide")},!1),d.addEventListener(h,function(){m.toggleMenu()},!1),o.addEventListener("scroll",function(){var e=p.scrollTop;m.toggleGotop(e),m.fixedHeader(e),m.fixedToc(e)},!1),c("#post-toc")&&c("#post-toc").addEventListener("mousewheel",function(e){var t=this.scrollTop,i=this.scrollHeight,n=this.clientHeight,s=e.deltaY;(s<0&&t<=-s||0<s&&i-n-t<=s)&&e.preventDefault()},!1),"undefined"!=typeof BLOG_SHARE&&m.share(),Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])}(window,document);